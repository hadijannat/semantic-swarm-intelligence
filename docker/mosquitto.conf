# Mosquitto MQTT Broker Configuration
# For NOA Semantic Swarm Mapper development environment

# =============================================================================
# General Settings
# =============================================================================

# Persistence - store messages and subscriptions
persistence true
persistence_location /mosquitto/data/

# Logging
log_dest stdout
log_type error
log_type warning
log_type notice
log_type information

# =============================================================================
# Listener Configuration
# =============================================================================

# Main MQTT listener (unencrypted for development)
listener 1883
protocol mqtt

# Allow anonymous connections (development only!)
allow_anonymous true

# WebSocket listener for browser clients (Gradio dashboard)
listener 9001
protocol websockets

# =============================================================================
# Message Settings
# =============================================================================

# Maximum message size (10MB for model updates)
message_size_limit 10485760

# Queue settings for QoS 1 and 2
max_queued_messages 1000
max_inflight_messages 20

# Retain messages for consensus state
retain_available true

# =============================================================================
# Connection Settings
# =============================================================================

# Keepalive for idle connections
keepalive_interval 60

# Maximum connections
max_connections -1

# =============================================================================
# Security (Production: Enable TLS)
# =============================================================================
# For production, uncomment and configure:
# listener 8883
# protocol mqtt
# cafile /mosquitto/certs/ca.crt
# certfile /mosquitto/certs/server.crt
# keyfile /mosquitto/certs/server.key
# require_certificate false
